# Using Inverse Euler Equations to Solve Multidimensional Discrete-continuous Dynamic Models: A General Method

Repository for `Using Inverse Euler Equations to Solve Multidimensional Discrete-continuous Dynamic Models: A General Method' by Isabella Dobrescu and Akshay Shanker. 

The repo. contains:

- A simple and extended version of the roof-top cut (RFC) algorithm.  
- Applications which implement the paper's results on inverse constrained Euler equations. 

## Abstract

We develop a general inverse Euler equation method to efficiently solve any multidimensional stochastic dynamic optimization problem with agents facing discrete-continuous choices and occasionally binding constraints. First, we provide a discrete time analogue to the Hamiltonian to (painlessly) recover the generalized necessary Euler equation. We then establish necessary and sufficient conditions to determine the existence of an Euler equation inverse, and the structure of the exogenous computational grid on which the inverse is well-defined. To handle applications with non-convexities generated by discrete choices, we finally present an off-the-shelf `rooftop-cut' algorithm guaranteed to asymptotically recover the optimal policy function under standard economic assumptions. We demonstrate our approach using two workhorse applications in the literature, and document the computational speed and accuracy gains our method generates.

## Application 1: 2D pension saving and retirement choice model by Dreudhal and Jorgensen (2017)

```
python3 plotPension.py
``` 

### Four constrained regions 

With four constraints regions as in Dreudhal and Jorgensen (2017). 

<center>

|                   | RFC+ Delaunay | G2EGM |
|-------------------|---------------|-------|
| Total time (min.)  | 2.61          | 2.64  |
| Euler errors      |               |       |
| All (average)     | -6.660        |-6.572 |
| 5th percentile    | -7.772        | -7.631|
| 95th percentile   | -4.423        | -4.964|
| Median            | -6.930        | -6.713|

</center>

### Six constrained regions 

Additional constraint upper-bound on pension deposits, which leads to six constrained regions (50\% increase in constrained regions).

Under G2EGM, number of total interpolants over which to calculate grid points is now six, leading to 50% increase in time. 

Using Theorem 1 to eliminate sub-optimal points that violate complementary slackness in the exogenous grid, the number of grid points in the six region case can be reduced to be approximately equal to the number of points in the four region case; this is because in the RFC implmentation, the optimal endogenous grid points cover approximately the same area in the endogenous grid space.

<center>

|                     | RFC+ Delaunay | G2EGM      |
|---------------------|---------------|------------|
| Total time (min.)    | 2.32          | 3.73       |
| Euler errors        |               |            |
| All (average)       | -6.542        | -5.872     |
| 5th percentile      | -7.855        | -7.593     |
| 95th percentile     | -3.982        | -1.807     |
| Median              | -6.844        | -6.531     |

</center>


### Acknowledgements

RFC and the paper's results are applied to an implementation of the pension and retirement choice example originally developed by Druedhal and Jorgensen (2017), which is available under the MIT License. The original G2EGM code has been adapted in this project to:

1. Invert the Euler equation according to the necessary conditions described in Dobrescu and Shanker (2024).
2. Implement the roof-top cut algorithm for comparison with G2EGM upper-envelope algorithm.

We gratefully acknowledge the computational modules by Druedhal, and the modifications made for this project are highlighted within the corresponding code files.
