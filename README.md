# Discrete-continuous High Dimensional Dynamic Optimization
Repository for `Discrete-continuous High Dimensional Dynamic Optimization' by Dobrescu and Shanker (2024)

We provide a rigorous and unified foundation of the Euler equation and the Endogenous Grid Method (EGM) for a general multidimensional stochastic dynamic optimization problem with discrete and continuous states, non-smooth constraints, unbounded rewards, and non-compact feasibility correspondences. Our contribution is threefold. First, we provide a real-valued analogue to the Hamiltonian used to (painlessly) recover the necessary Euler equation for any stochastic dynamic optimization application. Second, we provide the necessary and sufficient conditions on model primitives that determine the invertibility of the Euler equation, and geometric structure of the exogenous grid. Third, we present a general, computationally efficient, user-friendly `rooftop-cut' (RFC) algorithm to compute the upper envelope of the value correspondence generated by EGM in discrete-continuous models. The algorithm asymptotically recovers the optimal solution and provides error bounds under standard assumptions. Finally, we illustrate our contributions with two workhorse applications tackling retirement choice and savings, and housing investments under frictions.

## Benchmark application: pension saving and retirement by Dreudhal and Jorgensen (2017)

```
python3 plotPension.py
``` 

<center>

|                   | RFC+ Delaunay | G2EGM |
|-------------------|---------------|-------|
| Total time (min)  | 2.61          | 2.64  |
| Euler errors      |               |       |
| All (average)     | -6.660        |-6.572 |
| 5th percentile    | -7.772        | -7.631|
| 95th percentile   | -4.423        | -4.964|
| Median            | -6.930        | -6.713|

</center>
