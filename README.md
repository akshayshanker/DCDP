# Discrete-continuous High Dimensional Dynamic Optimization
Repository for `Discrete-continuous High Dimensional Dynamic Optimization' by Dobrescu and Shanker (2024)

We develop a general and rigorous theory of inverse dynamic programming to efficiently and accurately solve multidimensional stochastic dynamic optimization problems using the Euler equation. First, we provide a real-valued analogue to the Hamiltonian to (painlessly) recover the generalized necessary Euler equation, which covers applications with discrete choices, unbounded utility and occasionally binding constraints. We then give conditions to completely characterize invertibility of the Euler equation and practical construction of the exogenous grids. To handle non-convexities generated by discrete choices, we present an off-the-shelf `rooftop-cut' algorithm that selects the upper envelope of the value correspondence generated by solutions to  the Euler equation. The algorithm is compatible with massively parallel vectorized computing and asymptotically recovers the optimal policy function under standard economic conditions. We illustrate our contributions with two workhorse applications tackling retirement choice and savings, and investments under liquidity frictions.
## Benchmark application: 2D pension saving and retirement by Dreudhal and Jorgensen (2017)

```
python3 plotPension.py
``` 

<center>

|                   | RFC+ Delaunay | G2EGM |
|-------------------|---------------|-------|
| Total time (min)  | 2.61          | 2.64  |
| Euler errors      |               |       |
| All (average)     | -6.660        |-6.572 |
| 5th percentile    | -7.772        | -7.631|
| 95th percentile   | -4.423        | -4.964|
| Median            | -6.930        | -6.713|

</center>
