# Using inverse Euler equations to solve multidimensional discrete-continuous dynamic models: A general method
Repository for `Using inverse Euler equations to solve multidimensional discrete-continuous dynamic models: A general method'  by Dobrescu and Shanker. 

We develop a general inverse Euler equation method to efficiently solve any multidimensional stochastic dynamic optimization problem with agents facing discrete-continuous choices and occasionally binding constraints. First, we provide a discrete time analogue to the Hamiltonian to (painlessly) recover the generalized necessary Euler equation. We then establish necessary and sufficient conditions to determine the existence of an Euler equation inverse, and the structure of the exogenous computational grid on which the inverse is well-defined. To handle applications with non-convexities generated by discrete choices, we finally present an off-the-shelf `rooftop-cut' algorithm guaranteed to asymptotically recover the optimal policy function under standard economic assumptions. We demonstrate our approach using two workhorse applications in the literature, and document the computational speed and accuracy gains our method generates.
## Benchmark application: 2D pension saving and retirement by Dreudhal and Jorgensen (2017)

With four constraints regions as in Dreudhal and Jorgensen (2017). 

```
python3 plotPension.py
``` 

<center>

|                   | RFC+ Delaunay | G2EGM |
|-------------------|---------------|-------|
| Total time (min)  | 2.61          | 2.64  |
| Euler errors      |               |       |
| All (average)     | -6.660        |-6.572 |
| 5th percentile    | -7.772        | -7.631|
| 95th percentile   | -4.423        | -4.964|
| Median            | -6.930        | -6.713|

</center>


Additional constraint upper-bound on pension deposits and six constrained regions (50\% increase in constrained regions).

Under G2EGM, number of total interpolants over which to calculate upper envelople is now six -- a seperate interpolant and endogenous grid for each constrained region -- leading to 50% increase in time. 

Using Theorem 1 to eliminate sub-optimal points that violate complementary slackness *in the exogenous grid*, the number of grid points in the six region case can be reduced to be approximately equal to the number of points in the four region case; this is because in the RFC implmentation, the optimal endogenous grid points cover approximately the same area in the endogenous grid space. 

|                     | RFC+ Delaunay | G2EGM      |
|---------------------|---------------|------------|
| All (average)       | -6.231        | -5.130     |
| 5th percentile      | -7.467        | -7.149     |
| 95th percentile     | -4.156        | -1.433     |
| Median              | -6.472        | -6.103     |
| Total time (min)    | 1.07          | 1.67       |
| Inversion time (min)| 0.08          | 0.00       |
| RFC time (min)      | 0.29          | 0.00       |


